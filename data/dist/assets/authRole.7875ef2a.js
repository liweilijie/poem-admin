import{e,l as t,f as l}from"./index.5d61a7e0.js";const a={class:"app-container"},o=Vue.createElementVNode("h4",{class:"form-header h4"},"基本信息",-1),u=Vue.createElementVNode("h4",{class:"form-header h4"},"角色信息",-1),n={style:{"text-align":"center","margin-left":"-120px","margin-top":"30px"}},r=Vue.createTextVNode("提交"),i=Vue.createTextVNode("返回"),V=Vue.defineComponent({name:"AuthRole"}),d=Object.assign(V,{setup(V){const d=useRoute(),{proxy:c}=Vue.getCurrentInstance(),s=Vue.ref(!0),p=Vue.ref(0),m=Vue.ref(1),v=Vue.ref(10),f=Vue.ref([]),_=Vue.ref([]),h=Vue.ref({nickName:void 0,userName:void 0,userId:void 0});function w(e){c.$refs.roleRef.toggleRowSelection(e)}function C(e){f.value=e.map((e=>e.role_id))}function N(e){return e.role_id}function g(){c.$router.back(),c.$tab.closeOpenPage()}return async function(){const e=d.params&&d.params.userId,a={page_num:1,page_size:9999999999};if(e){s.value=!0;const o=await t(a);_.value=o.list,p.value=o.total;const u=await l({user_id:e});h.value=u.user_info;const n=u.role_ids;Vue.nextTick((()=>{_.value.forEach((e=>{n.includes(e.role_id)&&c.$refs.roleRef.toggleRowSelection(e)}))})),s.value=!1}}(),(t,l)=>{const V=Vue.resolveComponent("el-input"),d=Vue.resolveComponent("el-form-item"),x=Vue.resolveComponent("el-col"),b=Vue.resolveComponent("el-row"),k=Vue.resolveComponent("el-form"),y=Vue.resolveComponent("el-table-column"),R=Vue.resolveComponent("el-table"),E=Vue.resolveComponent("pagination"),S=Vue.resolveComponent("el-button"),$=Vue.resolveDirective("loading");return Vue.openBlock(),Vue.createElementBlock("div",a,[o,Vue.createVNode(k,{model:h.value,"label-width":"80px"},{default:Vue.withCtx((()=>[Vue.createVNode(b,null,{default:Vue.withCtx((()=>[Vue.createVNode(x,{span:8,offset:2},{default:Vue.withCtx((()=>[Vue.createVNode(d,{label:"用户昵称",prop:"user_nickname"},{default:Vue.withCtx((()=>[Vue.createVNode(V,{modelValue:h.value.user_nickname,"onUpdate:modelValue":l[0]||(l[0]=e=>h.value.user_nickname=e),disabled:""},null,8,["modelValue"])])),_:1})])),_:1}),Vue.createVNode(x,{span:8,offset:2},{default:Vue.withCtx((()=>[Vue.createVNode(d,{label:"登录账号",prop:"user_name"},{default:Vue.withCtx((()=>[Vue.createVNode(V,{modelValue:h.value.user_name,"onUpdate:modelValue":l[1]||(l[1]=e=>h.value.user_name=e),disabled:""},null,8,["modelValue"])])),_:1})])),_:1})])),_:1})])),_:1},8,["model"]),u,Vue.withDirectives((Vue.openBlock(),Vue.createBlock(R,{"row-key":N,onRowClick:w,ref:"roleRef",onSelectionChange:C,data:_.value.slice((m.value-1)*v.value,m.value*v.value)},{default:Vue.withCtx((()=>[Vue.createVNode(y,{label:"序号",type:"index",align:"center"},{default:Vue.withCtx((e=>[Vue.createElementVNode("span",null,Vue.toDisplayString((m.value-1)*v.value+e.$index+1),1)])),_:1}),Vue.createVNode(y,{type:"selection","reserve-selection":!0,width:"55"}),Vue.createVNode(y,{label:"角色编号",align:"center",prop:"role_id",width:"100","show-overflow-tooltip":""}),Vue.createVNode(y,{label:"角色名称",align:"center",prop:"role_name"}),Vue.createVNode(y,{label:"权限字符",align:"center",prop:"role_key"}),Vue.createVNode(y,{label:"创建时间",align:"center",prop:"created_at",width:"180"},{default:Vue.withCtx((e=>[Vue.createElementVNode("span",null,Vue.toDisplayString(t.parseTime(e.row.created_at)),1)])),_:1})])),_:1},8,["data"])),[[$,s.value]]),Vue.withDirectives(Vue.createVNode(E,{total:p.value,page:m.value,"onUpdate:page":l[2]||(l[2]=e=>m.value=e),limit:v.value,"onUpdate:limit":l[3]||(l[3]=e=>v.value=e)},null,8,["total","page","limit"]),[[Vue.vShow,p.value>0]]),Vue.createVNode(k,{"label-width":"100px"},{default:Vue.withCtx((()=>[Vue.createElementVNode("div",n,[Vue.createVNode(S,{type:"primary",onClick:l[4]||(l[4]=t=>function(){const t=h.value.id,l=f.value;e({user_id:t,role_ids:l}).then((e=>{c.$modal.msgSuccess("授权成功"),g()}))}())},{default:Vue.withCtx((()=>[r])),_:1}),Vue.createVNode(S,{onClick:l[5]||(l[5]=e=>g())},{default:Vue.withCtx((()=>[i])),_:1})])])),_:1})])}}});export{d as default};
