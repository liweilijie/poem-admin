import{s as e}from"./index.5d61a7e0.js";const t={class:"app-container"},a=Vue.createElementVNode("span",null,[Vue.createTextVNode(" 数据权限测试：user 为部门A2,"),Vue.createElementVNode("br"),Vue.createTextVNode(" -- 右上角头像切换角色"),Vue.createElementVNode("br"),Vue.createTextVNode(" 1：超级管理员为全部权限:显示全部数据"),Vue.createElementVNode("br"),Vue.createTextVNode(" 2：自定数据权限：显示部门A1数据"),Vue.createElementVNode("br"),Vue.createTextVNode(" 3：本部门数据权限：显示部门A2数据"),Vue.createElementVNode("br"),Vue.createTextVNode(" 4：本部门及以下数据权限：显示部门A2及以下数据(包括A21)"),Vue.createElementVNode("br"),Vue.createTextVNode(" 5：仅本人数据权限:显示本人数据"),Vue.createElementVNode("br")],-1),u=Vue.createTextVNode("搜索"),l=Vue.createTextVNode("重置"),o=Vue.createTextVNode("新增"),r=Vue.createTextVNode("删除"),V={class:"dialog-footer"},d=Vue.createTextVNode("确 定"),n=Vue.createTextVNode("取 消"),i=Vue.defineComponent({name:"DataScope"}),c=Object.assign(i,{setup(i){const{proxy:c}=Vue.getCurrentInstance(),p=Vuex.useStore(),s=Vue.ref([]),m=Vue.ref(!1),f=Vue.ref(!0),h=Vue.ref(!0),_=Vue.ref([]),v=Vue.ref(!0),N=Vue.ref(!0),b=Vue.ref(0),x=Vue.ref(""),g=Vue.reactive({form:{},queryParams:{page_num:1,page_size:10,data_a:void 0,data_b:void 0,__r__:p.getters.role},rules:{data_a:[{required:!0,message:"岗位名称不能为空",trigger:"blur"}],data_b:[{required:!0,message:"岗位编码不能为空",trigger:"blur"}]}}),{queryParams:C,form:w,rules:y}=Vue.toRefs(g);function T(){var t;f.value=!0,(t=C.value,e({url:"/test/data_scope/list",method:"get",params:t})).then((e=>{s.value=e.list,b.value=e.total,f.value=!1}))}function S(){m.value=!1,k()}function k(){w.value={id:void 0,data_a:void 0,data_b:void 0},c.resetForm("postRef")}function E(){C.value.page_num=1,T()}function A(){c.resetForm("queryRef"),E()}function K(e){_.value=e.map((e=>e.id)),v.value=1!=e.length,N.value=!e.length}function U(){k(),m.value=!0,x.value="添加岗位"}function B(){c.$refs.postRef.validate((t=>{t&&(null!=w.value.post_id?c.$modal.msgSuccess("不支持修改"):function(t){return e({url:"/test/data_scope/add",method:"post",data:t})}(w.value).then((e=>{c.$modal.msgSuccess("新增成功"),m.value=!1,T()})))}))}function R(t){const a=t.id?[t.id]:_.value;c.$modal.confirm('是否确认删除岗位编号为"'+a+'"的数据项？').then((function(){return function(t){return e({url:"/test/data_scope/delete",method:"delete",data:t})}({ids:a})})).then((()=>{T(),c.$modal.msgSuccess("删除成功")})).catch((()=>{}))}return T(),(e,i)=>{const c=Vue.resolveComponent("el-input"),p=Vue.resolveComponent("el-form-item"),_=Vue.resolveComponent("el-button"),v=Vue.resolveComponent("el-form"),g=Vue.resolveComponent("el-col"),k=Vue.resolveComponent("right-toolbar"),q=Vue.resolveComponent("el-row"),D=Vue.resolveComponent("el-table-column"),$=Vue.resolveComponent("el-table"),P=Vue.resolveComponent("pagination"),z=Vue.resolveComponent("el-dialog"),j=Vue.resolveDirective("loading");return Vue.openBlock(),Vue.createElementBlock("div",t,[a,Vue.withDirectives(Vue.createVNode(v,{model:Vue.unref(C),ref:"queryRef",inline:!0,"label-width":"68px"},{default:Vue.withCtx((()=>[Vue.createVNode(p,{label:"Id",prop:"id"},{default:Vue.withCtx((()=>[Vue.createVNode(c,{modelValue:Vue.unref(C).id,"onUpdate:modelValue":i[0]||(i[0]=e=>Vue.unref(C).id=e),placeholder:"请输入id",clearable:"",onKeyup:Vue.withKeys(E,["enter"])},null,8,["modelValue","onKeyup"])])),_:1}),Vue.createVNode(p,{label:"dataA",prop:"data_a"},{default:Vue.withCtx((()=>[Vue.createVNode(c,{modelValue:Vue.unref(C).data_a,"onUpdate:modelValue":i[1]||(i[1]=e=>Vue.unref(C).data_a=e),placeholder:"请输入A",clearable:"",onKeyup:Vue.withKeys(E,["enter"])},null,8,["modelValue","onKeyup"])])),_:1}),Vue.createVNode(p,{label:"dataB",prop:"data_b"},{default:Vue.withCtx((()=>[Vue.createVNode(c,{modelValue:Vue.unref(C).data_b,"onUpdate:modelValue":i[2]||(i[2]=e=>Vue.unref(C).data_b=e),placeholder:"请输入B",clearable:"",onKeyup:Vue.withKeys(E,["enter"])},null,8,["modelValue","onKeyup"])])),_:1}),Vue.createVNode(p,null,{default:Vue.withCtx((()=>[Vue.createVNode(_,{type:"primary",icon:"Search",onClick:E},{default:Vue.withCtx((()=>[u])),_:1}),Vue.createVNode(_,{icon:"Refresh",onClick:A},{default:Vue.withCtx((()=>[l])),_:1})])),_:1})])),_:1},8,["model"]),[[Vue.vShow,h.value]]),Vue.createVNode(q,{gutter:10,class:"mb8",style:{height:"35px"}},{default:Vue.withCtx((()=>[Vue.createVNode(g,{span:1.5},{default:Vue.withCtx((()=>[Vue.createVNode(_,{type:"primary",plain:"",icon:"Plus",onClick:U},{default:Vue.withCtx((()=>[o])),_:1})])),_:1},8,["span"]),Vue.createVNode(g,{span:1.5},{default:Vue.withCtx((()=>[Vue.createVNode(_,{type:"danger",plain:"",icon:"Delete",disabled:N.value,onClick:R},{default:Vue.withCtx((()=>[r])),_:1},8,["disabled"])])),_:1},8,["span"]),Vue.createVNode(k,{showSearch:h.value,"onUpdate:showSearch":i[3]||(i[3]=e=>h.value=e),onQueryTable:T},null,8,["showSearch"])])),_:1}),Vue.withDirectives((Vue.openBlock(),Vue.createBlock($,{data:s.value,onSelectionChange:K},{default:Vue.withCtx((()=>[Vue.createVNode(D,{type:"selection",width:"55",align:"center"}),Vue.createVNode(D,{label:"id",align:"center",prop:"id"}),Vue.createVNode(D,{label:"数据A",align:"center",prop:"data_a"}),Vue.createVNode(D,{label:"数据B",align:"center",prop:"data_b"}),Vue.createVNode(D,{label:"创建人",align:"center",prop:"created_by"})])),_:1},8,["data"])),[[j,f.value]]),Vue.withDirectives(Vue.createVNode(P,{total:b.value,page:Vue.unref(C).page_num,"onUpdate:page":i[4]||(i[4]=e=>Vue.unref(C).page_num=e),limit:Vue.unref(C).page_size,"onUpdate:limit":i[5]||(i[5]=e=>Vue.unref(C).page_size=e),onPagination:T},null,8,["total","page","limit"]),[[Vue.vShow,b.value>0]]),Vue.createVNode(z,{title:x.value,modelValue:m.value,"onUpdate:modelValue":i[8]||(i[8]=e=>m.value=e),width:"500px","append-to-body":""},{footer:Vue.withCtx((()=>[Vue.createElementVNode("div",V,[Vue.createVNode(_,{type:"primary",onClick:B},{default:Vue.withCtx((()=>[d])),_:1}),Vue.createVNode(_,{onClick:S},{default:Vue.withCtx((()=>[n])),_:1})])])),default:Vue.withCtx((()=>[Vue.createVNode(v,{ref:"postRef",model:Vue.unref(w),rules:Vue.unref(y),"label-width":"80px"},{default:Vue.withCtx((()=>[Vue.createVNode(p,{label:"data_a",prop:"data_a"},{default:Vue.withCtx((()=>[Vue.createVNode(c,{modelValue:Vue.unref(w).data_a,"onUpdate:modelValue":i[6]||(i[6]=e=>Vue.unref(w).data_a=e),placeholder:"A"},null,8,["modelValue"])])),_:1}),Vue.createVNode(p,{label:"data_b",prop:"data_b"},{default:Vue.withCtx((()=>[Vue.createVNode(c,{modelValue:Vue.unref(w).data_b,"onUpdate:modelValue":i[7]||(i[7]=e=>Vue.unref(w).data_b=e),placeholder:"B"},null,8,["modelValue"])])),_:1})])),_:1},8,["model","rules"])])),_:1},8,["title","modelValue"])])}}});export{c as default};
